<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scheduling</title>
  <link rel="stylesheet" href="./frontend_stuff/general_style.css?v=1.0">
  <style>
    body {
      background: #e4e4e4;
      height: 100%;
      /* Ensure parent elements take up full viewport height */
    }

    .container {
      width: 100%;
      margin: 4vw auto;
      height: 100%;
      flex-direction: column;
      /* Stack items vertically */
    }

    /* Read section behind form */
    .container .card {
      max-width: 65vw;
      height: 100%;
      width: 100%;
      border-radius: 10px;
      border: none;
      margin: 0 auto;
      z-index: 0;
      position: relative;
      background: #ae0e1d;
      border-left: 1px solid #3b3d3f;
      border-right: 1px solid #3b3d3f;
    }

    /* Tabs*/
    .tabs {
      text-align: left;
      position: relative;
    }

    .tabs input {
      position: absolute;
      opacity: 0;
    }

    .tabs input+label {
      margin: 10px 0;
      min-width: 110px;
      width: 16vw;
      transition: all 0.3s;
      text-align: center;
      border: none;
      color: rgb(201, 201, 201);
      display: inline-flex;
      -webkit-box-pack: center;
      padding: 8px 12px;
      vertical-align: top;
      justify-content: flex-start;
      box-shadow: 1px -1px 2px 0px #231f20;
      text-transform: uppercase;
      font-size: 0.85rem;
      margin-bottom: 0.5px;
      border-radius: 7px 7px 0 0 !important;
      letter-spacing: 0.1666666667em !important;
      font-family: 'Work Sans', 'Montserrat', Arial, sans-serif;
      background: white;
      cursor: pointer;
    }

    #tab-2+label {
      margin-left: -0.112cm;
    }

    #tab-2:checked+label,
    #tab-1:checked+label {
      color: #ed1b2f;
    }

    .tabs input+label:hover {
      color: black;
      transition: 0.1s ease;
    }

    /* Glider */
    .glider {
      width: 16vw;
      height: 3px;
      position: absolute;
      background: #ed1b2f;
      transition: all 0.3s;
      top: 40px;
      z-index: 2;
    }

    #tab-2:checked~.glider {
      left: 16vw;
    }

    /* Content*/
    #tab-1:checked~section #content-1,
    #tab-2:checked~section #content-2 {
      opacity: 1;
      visibility: visible;
    }

    h2.tab-title.tab-onetime,
    h2.tab-title.tab-weekly {
      display: inline-flex;
      width: 40vw;
      color: #fff;
      margin-bottom: 30px;
      margin-top: 30px;
      background-clip: text !important;
      color: #ae0e1d;
      text-transform: capitalize;
      font-size: 24px;
      font-weight: 800 !important;
    }

    .content {
      margin: 0px auto;
      text-align: left;
      line-height: 20px;
      width: 100%;
      min-height: 600px;
      height: auto;
      border-bottom-left-radius: 10px;
      border-bottom-right-radius: 10px;
      box-shadow: 0 2px 3px rgb(10 10 10 / 20%), 0 0 0 1px rgb(10 10 10 / 20%);
      display: block;
      z-index: 2;
      border-top: 1px solid #3b3d3f;
      background: white;
      position: relative;
      overflow-y: auto;
      align-items: center;
      justify-content: center;
      padding: 0.5vw 3vw;
    }

    .content .item {
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      position: absolute;
      padding: 10px 20px;
    }

    .content p {
      margin: 10px 15px 10px 0;
      letter-spacing: 0.75px;
      font-size: 14pt;
      font-style: normal;
      color: black;
      line-height: 30px;
      margin-top: 10pt;
      font-family: "freight-display-pro";
      font-weight: 300 !important;
    }

    /* Form Styling */

    /* Center the form container */
    .schedule-form {
      width: 55vw;
      display: flex;
      flex-direction: column;
      gap: 0px;
      margin: 0 auto;
      box-sizing: border-box;
      text-align: left;
      justify-content: center;
    }

    /* Label styling to ensure they stay on the left */
    .schedule-form label {
      display: block;
      text-align: left;
      margin-bottom: 5px;
    }

    .schedule-form input,
    .schedule-form select,
    .schedule-form textarea {
      width: 100%;
      padding: 0;
      /* padding: 8px; */
      margin-bottom: 2px;
    }

    .schedule-form label input[type="checkbox"] {
      margin-right: 0;
    }

    button.reset-btn,
    button.save-btn {
      padding: 10px 20px;
    }

    button.reset-btn {
      margin-top: 3vw;
      margin-right: -1vw;
    }

    .schedule-form label {
      text-align: left;
      display: block;
    }

    .schedule-form .days-of-week {
      display: flex;
      flex-wrap: wrap;
      /* Allow wrapping to the next line */
      gap: 10px;
      /* Space between day options */
      justify-content: left;
      /* Center all elements */
    }

    .schedule-form .day-option {
      margin-right: 10px;
      display: flex;
      align-items: left;
      /* Keep checkbox and label aligned */
      gap: 7px;
      /* Space between checkbox and label */
    }



    input[type="text"],
    input[type="checkbox"],
    input[type="time"],
    input[type="date"],
    input[type="number"],
    input[type="datetime-local"] {
      /* ensures checkboxes are visible */
      position: static;
      opacity: 1;
    }

    input[type="text"],
    input[type="textarea"] {
      background-color: #e4e4e4;
      border: none;
      border-radius: 6px;
      padding: 10px 8px;
      margin-top: 3px;
    }

    button.save-btn {
      box-sizing: content-box;
    }

    .time-inputs label,
    .date-inputs label {
      display: inline-block;
      margin-right: 10px;
      font-size: 10px;
      color: grey;
    }

    .reset-btn {
      position: absolute;
      top: -1vw;
      right: 2.6vw;
      background: #ae0e1d;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 5px;
    }

    .form-times text,
    .form-datetime {
      font-family: 'Inter', 'Helvetica Neue', sans-serif;
      font-size: 1rem;
    }

    /* Modal Background Styling */
    .modal {
      display: none;
      position: fixed;
      z-index: 1001;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
    }

    .modal-content {
      inline-size: 2px;
      box-sizing: content-box;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ffffff;
      padding: 30px;
      border-radius: 10px;
      width: 80%;
      max-width: 400px;
      text-align: left;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      overflow-wrap: break-word;
      /* Ensures text wraps inside modal */
    }

    .modal-content p,
    .modal-content span {
      word-wrap: break-word;
      /* Ensures words/links break to fit container */
      word-break: break-all;
      /* Allows breaking links if necessary */
      overflow-wrap: break-word;
      ;
      /* Modern support for wrapping text */
      max-width: 100%;
      /* Prevents overflowing */
      display: block;
      /* Ensures proper stacking and alignment */
      margin-bottom: 5px;
    }

    .modal-content button {
      width: 150px;
    }

    .modal-buttons {
      display: flex;
      justify-content: flex-end;
      /* Aligns buttons to the right */
      gap: 10px;
      /* Adds space between buttons */
      margin-top: 20px;
      /* Adds some spacing above the buttons */
    }

    body.modal-open {
      overflow: break-word;
    }

    .close-btn {
      float: right;
      cursor: pointer;

    }

    .close-btn:hover {
      color: #ed1b2f;
    }
    /* pop-alert styles */
    .pop-alert {
        display: none;
        position: fixed;
        z-index: 1001;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
        }
        .pop-alert-content {
        background-color: #fff;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 400px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .pop-alert-close {
        margin-top: 10px;
        padding: 10px 20px;
        background-color: #ed1b2f;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        }
        .pop-alert-close:hover {
        background-color: #ed1b2f;
        }
  </style>
</head>

<body>
  <!--navigation bar with logo and etc-->
  <header>
    <div class="nav-container">
      <a href="dashboard" class="logo-link">
        <img src="./frontend_stuff/png/logo.png" alt="Logo" class="nav-logo-img">
        <span class="logo-name">SOC-cessful Schedule</span>
      </a>

      <div class="nav-buttons">
        <button id="profileLink" type="button" class="secondary profile-btn">
          <img src="./frontend_stuff/png/user-icon.png" alt="User" class="user-icon">
          <span>Account</span>
        </button>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item">History</a>
          <a href="#" class="dropdown-item">Preferences</a>
          <a href="#" class="dropdown-item">Time Requests</a>
          <a href="#" class="dropdown-item" style="color:#ed1b2f;">Log Out</a>
        </div>
      </div>
    </div>
  </header>

      <!-- Modal popup -->
      <div id="pop-alert" class="pop-alert">
        <div class="pop-alert-content">
            <p id="pop-alert-message"></p>
            <button class="pop-alert-close" onclick="closepopalert()">Close</button>
        </div>
    </div>

  <div class="container">
    <div class="card tabs">
      <input id="tab-1" type="radio" class="tab tab-selector" checked="checked" name="tab" />
      <label for="tab-1" class="tab tab-weekly">Weekly</label>

      <input id="tab-2" type="radio" class="tab tab-selector" name="tab" />
      <label for="tab-2" class="tab tab-onetime">One-Time</label>

      <div class="glider"></div>

      <section class="content">
        <div class="item" id="content-1">
          <h2 class="tab-title tab-weekly">Schedule Weekly Recurring Event</h2>
          <!-- Recurring Form -->
          <form id="recurring-form" class="schedule-form active" action="./database_stuff/schedule_recurring.php"
            method="POST">

            <label style="display: inline-block;">
              <input type="text" class="event-name" style="font-size: 1.2rem; height: 50px; margin-bottom: 0;"
                name="name" required placeholder="Your event name ">
            </label>

            <div class="form-location-ppl">
              <label style="display: inline-block; width: 36vw; margin-right: 0.05vw; ">
                <input type="text"
                  style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;"
                  name="location" required placeholder="Location/Video Call URL:">
              </label>
              <label style="display: inline-block; width:18.6vw;">
                <input type="number"
                  style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;"
                  name="participants" required placeholder="Number of Participants Allowed: ">
              </label>
            </div>
            <!-- day of the week: choose from monday to sunday buttons which days of the week it happens on each week -->
            <div class="schedule-form">
              <div class="label-and-days">
                <label for="days-of-week" style="margin-top: 20px;">Repeats on:</label>
                <div class="days-of-week" id="days-of-week">
                  <div class="day-option"><input type="checkbox" name="day[]" value="Monday">Monday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Tuesday">Tuesday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Wednesday">Wednesday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Thursday">Thursday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Friday">Friday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Saturday">Saturday</div>
                  <div class="day-option"><input type="checkbox" name="day[]" value="Sunday">Sunday</div>
                </div>
              </div>
            </div>


            <!-- time of the day for all the days selected -->
            <div class="form-times" style="margin-top: 5px;">
              <label for="start_time"
                style="display: inline-block; margin-right: 10px; font-size: 10; color: grey; padding-top: 15px; width: 7vw;">Start
                Time:
                <input type="time" name="start_time" style="display: inline-block; padding: 4px;" required></label>

              <label for="start_date"
                style="display: inline-block; margin-right: 10px; font-size: 10; color: grey; margin-right: 1vw; width: 10vw;">Start
                Date:
                <input type="date" name="start_date" style="display: inline-block; padding: 5px;" required></label>

              <text> to</text>

              <label for="end_time"
                style="display: inline-block; margin-right: 5px; font-size: 10; color: grey; width: 7vw; margin-left: 1vw;">End
                Time:
                <input type="time" name="end_time" style="display: inline-block; padding: 4px;" required></label>

              <label for="end_date"
                style="display: inline-block; margin-right: 10px; font-size: 10; color: grey; width: 10vw">End
                Date:
                <input type="date" name="end_date" style="display: inline-block; padding: 5px;" required></label>
            </div>


            <label style="margin-top: 20px;">Length of each meeting: </br>
              <select name="slot"
                style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;margin-top: 3px;">
                <option value="15">15 minutes</option>
                <option value="30">30 minutes</option>
                <option value="45">45 minutes</option>
                <option value="60">1 hour</option>
                <option value="0">NA</option>
              </select>
            </label>
            <label><textarea name="notes"
                style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px 20px;"
                placeholder="Description/Notes: "></textarea></label>
            <button type="reset" class="secondary reset-btn">Reset</button>
            <button type="submit" class="primary save-btn">Save</button>
          </form>
        </div>

        <div class="item" id="content-2">
          <h2 class="tab-title tab-onetime">Schedule One-Time Event</h2>
          <!-- One-Time Form -->
          <form id="one-time-form" class="schedule-form" action="./database_stuff/schedule_onetime.php" method="POST">
            <label style="display: inline-block;">
              <input type="text" class="event-name" style="font-size: 1.2rem; height: 50px; margin-bottom: 0;"
                name="name" required placeholder="Your event name ">
            </label>

            <div class="form-location-ppl">
              <label style="display: inline-block; width: 36vw; margin-right: 0.05vw; ">
                <input type="text"
                  style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;"
                  name="location" required placeholder="Location/Video Call URL:">
              </label>
              <label style="display: inline-block; width:18.6vw;">
                <input type="number"
                  style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;"
                  name="participants" required placeholder="Number of Participants Allowed: ">
              </label>
            </div>


            <div class="form-datetime" style="margin-top: 5px;">
              <label for="start_time"
                style="display: inline-block; margin-right: 10px; font-size: 10; color: grey; padding-top: 15px; width: 15vw;">
                Start Time:
                <input type="datetime-local" name="start_time" style="padding: 10px;" required></label>

              <text> to &nbsp;</text>

              <label for="end_time"
                style="display: inline-block;  font-size: 10; color: grey; padding-top: 15px; width: 15vw;">
                End Time:
                <input type="datetime-local" name="end_time" style="padding: 10px;" required></label>
            </div>

            <label style="margin-top: 20px;">Time Slot Length: </br>
              <select name="slot"
                style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px;margin-top: 3px;">
                <option value="15">15 minutes</option>
                <option value="30">30 minutes</option>
                <option value="45">45 minutes</option>
                <option value="60">1 hour</option>
                <option value="0">NA</option>
              </select>
            </label>
            <label><textarea name="notes"
                style="background-color: #e4e4e4; border: none; border-radius: 6px; padding: 10px 8px 30px;"
                placeholder="Description/Notes: "></textarea></label>
            <button type="reset" class="secondary reset-btn">Reset</button>
            <button type="submit" class="primary save-btn">Save</button>
          </form>
        </div>
      </section>
    </div>
  </div>

  <!-- Confirmation Pop-Up Modal-->
  <div id="confirmation-popup" class="modal">
    <div class="modal-content">
      <span class="close-btn" id="close-popup">&times;</span>
      <p style="font-weight: bold; font-size: 1.5rem; margin-bottom: 10px; margin-top: 5px;">Slot Scheduled! <br></p>
      <p>Information: <span id="popup-info"></span></p>
      <p>Link to Share: <span id="link-display">[Link]</span>
      </p>
      <p>Email: <span id="email-display">[Email]</span></p>
      <div class="modal-buttons">
        <button id="copy-link" class="secondary modal-btn">Copy Link</button>
        <button id="return-home" class="primary modal-btn">Home</button>
      </div>
    </div>
  </div>

  <script>
        function showpopalert(message) {
            document.getElementById('pop-alert-message').innerText = message;
            document.getElementById('pop-alert').style.display = 'block';
        }

        function closepopalert() {
            document.getElementById('pop-alert').style.display = 'none';
        }       
  </script>
  <script>
    document.forms['recurring-form'].addEventListener('submit', (event) => {
      event.preventDefault();
      // Get all the checkboxes for the days
      const dayCheckboxes = document.querySelectorAll('input[name="day[]"]');
      let isDaySelected = false;
      // Loop through the checkboxes to see if any are checked
      dayCheckboxes.forEach(function(checkbox) {
        if (checkbox.checked) {
          isDaySelected = true;
        }
      });
      if (!isDaySelected) {
        event.preventDefault(); // Prevent form submission
        showpopalert("Please select at least one day for the recurring event.");
//        alert("Please select at least one day for the recurring event.");
        // should not reset the form , only reset the checkboxes
        event.target.reset();
        return;
      }  const form = event.target;
      
      // Show loading message or disable form to indicate submission
      document.getElementById('recurring-form').querySelector('.save-btn').innerText = 'Submitting...';
      document.getElementById('recurring-form').querySelector('.save-btn').disabled = true;

      fetch(event.target.action, {
        method: 'POST',
        body: new URLSearchParams(new FormData(event.target)) // event.target is the form
      }).then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json(); // or response.text() or whatever the server sends
      }).then((body) => {
        console.log("Response received from recurring form submission");
        if (body.success) {
          console.log(body);
          // Populate the modal with the event details
          const event = body.eventDetails;
          document.getElementById("popup-info").innerText = `
                    Event: ${event.name}
                    \nLocation: ${event.location}
                    \nStart Time: ${event.start_time}
                    \nEnd Time: ${event.end_time}
                    \nStart Date: ${event.start_date}
                    \nEnd Date: ${event.end_date}
                    \nParticipants: ${event.participants}
                    \nSlot Length: ${event.slotDuration} minutes
                    \nNotes: ${event.notes}
                `;
          document.getElementById("email-display").innerText = event.email;
          document.getElementById("link-display").innerText = body.eventDetails.link;
          // Show the modal
          document.getElementById("confirmation-popup").style.display = "block";
        } else {
          alert(body.error);
          return;
        }
      }).catch((error) => {
        // TODO handle error
        console.log("Error:", error);
        showpopalert("An error occurred while scheduling the event.");
//        alert('An error occurred while scheduling the event.');
      }).finally(() => {
        // Re-enable the button after submission is complete
        document.getElementById('recurring-form').querySelector('.save-btn').innerText = 'Save';
        document.getElementById('recurring-form').querySelector('.save-btn').disabled = false;
      });
    });

    document.forms['one-time-form'].addEventListener('submit', (event) => {
      event.preventDefault();


      const form = event.target;
      // Check if the start time is before the end time
      const startTime = new Date(form.start_time.value);
      const endTime = new Date(form.end_time.value);
      if (startTime >= endTime) {
        event.preventDefault(); // Prevent form submission
        showpopalert("End time must be after start time.");
//        alert("End time must be after start time.");
        event.target.reset();
        return;
      }

      // Show loading message or disable form to indicate submission
      document.getElementById('one-time-form').querySelector('.save-btn').innerText = 'Submitting...';
      document.getElementById('one-time-form').querySelector('.save-btn').disabled = true;
      fetch(event.target.action, {
        method: 'POST',
        body: new URLSearchParams(new FormData(event.target)) // event.target is the form
      }).then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        return response.json(); // or response.text() or whatever the server sends
      }).then((body) => {
        console.log("Response received");
        console.log(body);
        if (body.success) {
          // Populate the modal with the event details
          const event = body.eventDetails;
          document.getElementById("popup-info").innerText = `
                    Event: ${event.name}
                    \nLocation: ${event.location}
                    \nStart Time: ${event.start_time}
                    \nEnd Time: ${event.end_time}
                    \nParticipants: ${event.participants}
                    \nSlot Length: ${event.slotDuration} minutes
                    \nNotes: ${event.notes}
                `;
          document.getElementById("email-display").innerText = event.email;
          document.getElementById("link-display").innerText = event.link;
          // Show the modal
          document.getElementById("confirmation-popup").style.display = "block";
        }
      }).catch((error) => {
        // TODO handle error
        console.log("Error:", error);
        alert(error);
      }).finally(() => {
        // Re-enable the button after submission is complete
        document.getElementById('one-time-form').querySelector('.save-btn').innerText = 'Save';
        document.getElementById('one-time-form').querySelector('.save-btn').disabled = false;
      });
    });

    //Close the confirmation popup
    document.getElementById("close-popup").onclick = function () {
      document.getElementById("confirmation-popup").style.display = "none";
    };

    // Copy Link Button
    document.getElementById("copy-link").addEventListener("click", function () {
      var copyText = document.getElementById("link-display");
      //copyText.select();
      //copyText.setSelectionRange(0, 99999);
      document.execCommand("copy");
      showpopalert("Link Copied");
//      alert("Link Copied");
    });

    // Return Home Button
    document.getElementById("return-home").addEventListener("click", function () {
      window.location.href = "dashboard";
    });

    function copyToClipboard() {
      const eventURLField = document.getElementById('link-display');
      const linkText = eventURLField.innerText;

      console.log("Copying text: ", linkText);

      navigator.clipboard.writeText(linkText).then(() => {
        //alert("Event URL copied to clipboard!");
        document.getElementById("confirmation-popup").style.display = "none";
        showpopalert("Event URL copied to clipboard!");
        console.log("Event URL copied to clipboard!");
      }).catch((error) => {
        console.error("Error copying text: ", error);
        document.getElementById("confirmation-popup").style.display = "none";
        showpopalert("Failed to copy event URL to clipboard.");
//        alert("Failed to copy event URL to clipboard.");
      });
    }
    document.getElementById("copy-link").addEventListener("click", copyToClipboard);

    // Function to reset only checkboxes
    function resetCheckboxes(checkboxes) {
      checkboxes.forEach(checkbox => {
        checkbox.checked = false;
      });
    }
  </script>
  <script>
    // sanitize all inputs to prevent < > and other injections
    const inputs = document.querySelectorAll('input');
    inputs.forEach(input => {
        input.addEventListener('input', () => {
            if (input.value.includes('<') || input.value.includes('>')) {
                input.value = input.value.replace(/[<>]/g, '');
                showpopalert('Please do not enter any special characters like < or >');
//                alert('Please do not enter any special characters like < or >');
            }
            // inputs cannot be a single 0
            else if (input.value === '0') {
                input.value = '';
                showpopalert('0 is not a valid name. Please enter a valid input');
//                alert('0 is not a valid name. Please enter a valid input');
            }
        });
    });

    //sanitize all textareas to prevent < > and other injections
    const textareas = document.querySelectorAll('textarea');
    textareas.forEach(textarea => {
        textarea.addEventListener('input', () => {
            if (textarea.value.includes('<') || textarea.value.includes('>')) {
                textarea.value = textarea.value.replace(/[<>]/g, '');
                showpopalert('Please do not enter any special characters like < or >');
                //alert('Please do not enter any special characters like < or >');
            }
        });
    });

    //dont allow input for participants to be negative or 0
    const participantsInput = document.querySelector('input[name="participants"]');
    participantsInput.addEventListener('input', () => {
        if (participantsInput.value <= 0) {
            participantsInput.value = 1;
            showpopalert('Please enter a valid number of participants');
//            alert('Please enter a valid number of participants');
        }
    });

    const startDateInput = document.querySelector('input[name="start_date"]');
    const endDateInput = document.querySelector('input[name="end_date"]');
    const startTimeInput = document.querySelector('input[name="start_time"]');
    const endTimeInput = document.querySelector('input[name="end_time"]');

    // Function to compare the full start and end datetime
    function compareDateTime() {
        const startDateTime = new Date(`${startDateInput.value}T${startTimeInput.value}`);
        const endDateTime = new Date(`${endDateInput.value}T${endTimeInput.value}`);

        // Check if the end date time is after the start date time
        if (startDateTime >= endDateTime) {
          showpopalert('End date and time must be after start date and time');
//            alert('End date and time must be after start date and time');
            endDateInput.value = '';
            endTimeInput.value = '';
        }
    }

    // Event listener for the start and end date and time fields
    startDateInput.addEventListener('input', compareDateTime);
    endDateInput.addEventListener('input', compareDateTime);
    startTimeInput.addEventListener('input', compareDateTime);
    endTimeInput.addEventListener('input', compareDateTime);


  </script>
</body>

</html>